<!DOCTYPE html> 
<html lang="en"> 
  
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content= 
        "width=device-width, initial-scale=1.0"> 
  
    <title>Speech to Text</title> 
</head> 
  
<body> 
    <div class="words" contenteditable> 
        <p id="p"></p> 
        <button onclick="listen()"></button>
    </div> 
  
    <script> 
        class SpeechGrammarList {
            constructor() {
                this.grammars = [];
            }
            addFromString(string, weight) {
                this.grammars.push(string);
            }
        }
        const listen = () => {
            var speech = true; 
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            recognition.maxAlternatives = 100;
            const grammar = "#JSGF V1.0; grammar colors; public <color> = aqua | azure | beige | bisque | black | blue | brown | chocolate | coral | crimson | cyan | fuchsia | ghostwhite | gold | goldenrod | gray | green | indigo | ivory | khaki | lavender | lime | linen | magenta | maroon | moccasin | navy | olive | orange | orchid | peru | pink | plum | purple | red | salmon | sienna | silver | snow | tan | teal | thistle | tomato | turquoise | violet | white | yellow ;";
            const SpeechGrammarList = window.SpeechGrammarList || window.webkitSpeechGrammarList;
            const speechRecognitionList = new SpeechGrammarList();
            speechRecognitionList.addFromString(grammar, 1000000000);
            recognition.grammars = speechRecognitionList;
            recognition.interimResults = true;
            console.log(recognition.grammars);
            const words = document.querySelector('.words'); 
            words.appendChild(p); 

            recognition.addEventListener('result', e => { 
                const transcript = Array.from(e.results) 
                    .map(result => result[0]) 
                    .map(result => result.transcript) 
                    .join('') 
                console.log(transcript); 
            });
            
            if (speech == true) { 
                recognition.start(); 
                recognition.addEventListener('end', () => {
                    speech = false;
                    recognition.start();
                });
            }
        }
        
    </script> 
</body> 
  
</html> 